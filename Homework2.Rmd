---
title: "Homework2"
author: "Pau Mateo"
date: "2024-05-25"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## AD - Homework 2

Import the data set "food-consumption.csv" that is related to consumption of certain food items in 16 different European and Scandinavian countries. The data set consists of 20 variables. The numbers represent the percentage of the population consuming that food type. The objectives of the study are: (i) to analyze relationships between countries and consumed food types. (ii) to cluster countries based on food consumption types.

**1. Application of Correspondence Analysis.**

```{r}
food.consumption <- read.csv("C:/Users/pauma/OneDrive/Escritorio/UNI/2n/AD/anàlisi_multivariant/Homeworks/Homework2/food-consumption.csv", stringsAsFactors=TRUE, row.names=1)
```

```{r}
head(food.consumption)
```

**a) Remove observations with missing values using function na.omit().**

```{r}
sum(is.na(food.consumption))
```
```{r}
food.consumption = na.omit(food.consumption)
sum(is.na(food.consumption))
```
:)

**b) Apply correspondence analysis by using CA() function in FactoMineR.**

```{r}
library(FactoMineR)
res.ca <- CA(food.consumption)
summary(res.ca)
```

**c) How many dimensions would you need to extract? Why?**

Tendríamos que extraer como mínimo 3 las tres primeras dimensiones para conseguir un porcentage decente de variabilidad explicada. Con sólo dos dimensiones tan solo llegaríamos a un 56%, que es demasiado poco, y con tres dimensiones llegamos a explicar un 69.757% de la variabilidad.

**d) Plot the row and column profiles on the extracted dimensions.**

```{r}
plot.CA(res.ca,axes = c(1,2))
plot.CA(res.ca,axes = c(1,3))
```


```{r}
#3D plot
res.ca_to_plot <- ca(food.consumption)
plot3d.ca(res.ca_to_plot, dim=c(1,2,3))
```



**e) Interpret the plot(s) considering**

(i) similarities between countries,

(ii) similarities between food categories.

(iii) the relationship between food categories and countries.

### 2. Application of Cluster Analysis.

**a) Compute a distance matrix.**

**b) Apply hierarchical cluster analysis to group countries according to their food consumption and plot dendrogram. (Try different methods but in the report just show the one that you prefer. Explain why you have chosen that method.)**

**c) How many clusters do you think there are? (Considering the dendrogram plot)**

**d) Draw an elbow plot showing within sum of squares per dimension. Interpret it.**

**e) Apply k-means clustering according to the number of groups you have chosen.**

**f) Compute the centroids (means) of the clusters and show them in a table.**

**g) Interpret the most important characteristics of each cluster according to the summary table given in section (f).**
