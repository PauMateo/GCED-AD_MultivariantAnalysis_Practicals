---
title: "Homework2"
author: "Pau Mateo"
date: "2024-05-25"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## AD - Homework 2

Import the data set "food-consumption.csv" that is related to consumption of certain food items in 16 different European and Scandinavian countries. The data set consists of 20 variables. The numbers represent the percentage of the population consuming that food type. The objectives of the study are: (i) to analyze relationships between countries and consumed food types. (ii) to cluster countries based on food consumption types.

**1. Application of Correspondence Analysis.**

```{r}
food_nutrient <- read.csv2("C:/Users/pauma/OneDrive/Escritorio/UNI/2n/AD/anàlisi_multivariant/lab/Lab5_ClusterAnalysis/food_nutrient.csv", stringsAsFactors=TRUE, row.names=2)
```

```{r}
head(food_nutrient)
```

La primera columna solo sirve de indexación, la podemos quitar.

```{r}
food_nutrient <- food_nutrient[-c(1)]
head(food_nutrient)
```

**a) Remove observations with missing values using function na.omit().**

```{r}
sum(is.na(food_nutrient))
```

Vemos que no tenemos *missing values* en este dataset.

**b) Apply correspondence analysis by using CA() function in FactoMineR.**

```{r}
library(FactoMineR)
res.ca <- CA(food_nutrient)
summary(res.ca)
```

**c) How many dimensions would you need to extract? Why?**

En este caso convendría extraer sólo las dos primeras dimensiones, ya que con éstas se consigue explicar un 98.486% de la variancia. Añadir una dimensión más solo augmentaria la varianza explicada en un 1.47%, y quitar la segunda dimensión nos dejaría con un 93.79% de la variabilidad explicada, que es significativamente menor que con la dos primeras dimensiones juntas.

**d) Plot the row and column profiles on the extracted dimensions.**

```{r}
plot.CA(res.ca,axes = c(1,2))
```

**e) Interpret the plot(s) considering**

(i) similarities between countries,

(ii) similarities between food categories.

(iii) the relationship between food categories and countries.

### 2. Application of Cluster Analysis.

**a) Compute a distance matrix.**

**b) Apply hierarchical cluster analysis to group countries according to their food consumption and plot dendrogram. (Try different methods but in the report just show the one that you prefer. Explain why you have chosen that method.)**

**c) How many clusters do you think there are? (Considering the dendrogram plot)**

**d) Draw an elbow plot showing within sum of squares per dimension. Interpret it.**

**e) Apply k-means clustering according to the number of groups you have chosen.**

**f) Compute the centroids (means) of the clusters and show them in a table.**

**g) Interpret the most important characteristics of each cluster according to the summary table given in section (f).**
